<!DOCTYPE html>

<!-- <h1>Hello World!</h1> -->



<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="dom-to-image.js"></script>
    <style>
        /* CSS HERE */
        /* @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap');
        #sitetext {
            font-family: 'Roboto', sans-serif;
        } */
    </style>
</head>

<body>
    <h1 id="sitetext">
        Facebook Post Generator
    </h1>
    <!-- INPUT FIELDS HERE -->
    <label for="raw_html" id="sitetext">Raw HTML</label>

    <textarea id="raw_html" name="raw_html" rows="4" cols="50"></textarea>


    <button onclick="runit()">ENGAGE</button>

    <div id="newContent" style="width: 2400px; height: 2400px;">
    </div>

    <!-- <canvas id="myCanvas" width="1200" height="1200"></canvas>
    <div id="canvasImg"></div> -->
    <script>
        // JS HERE
        function runit() {
            // Replacement stuff
            var myHTML = $('#raw_html').val();
            var mySeparator = "background-image: url(";
            var splitHTML = myHTML.split(mySeparator);
            // Replace img 1 path
            var split2 = splitHTML[1].split(");");
            var img1name = split2[0].split("/");
            img1name = img1name[img1name.length - 1];
            img1name = "images/" + img1name;
            // Replace img 2 path
            var split22 = splitHTML[2].split(");");
            var img2name = split22[0].split("/");
            img2name = img2name[img2name.length - 1];
            img2name = "images/" + img2name;


            // Combine string
            var newHTML = splitHTML[0] + mySeparator + splitHTML[1].replace(split2[0], img1name) + mySeparator + splitHTML[2].replace(split22[0], img2name)
            
            
            // Change font of the title


            // height: 400px;
            newHTML = newHTML.replace('height: 400px;', 'height: 800px;');



            newHTML = newHTML.replace('Roboto', 'Poppins');
            var separator1 = ".parent {";
            var newSplit = newHTML.split(separator1);
            var newContent = "\n   background-color: black; \n";
            newHTML = newSplit[0] + separator1 + newContent + newSplit[1];
            console.log(newHTML);


            


            


            $("#newContent").html(newHTML);
            

            replacedLink = "<h2>autoknowmentoring.com.au<h2>"

            // Find element containing link 
            var link = document.getElementsByClassName("btn btn-md btn-primary hestia-subscribe-button")[0];
            console.log(link);
            link.outerHTML = replacedLink;
            

            // Change fonts in everything





            var node = document.getElementById('newContent');

            domtoimage.toPng(node)
                .then(function (dataUrl) {
                    var img = new Image();
                    img.src = dataUrl;
                    document.body.appendChild(img);
                })
                .catch(function (error) {
                    console.error('oops, something went wrong!', error);
                });




            // console.log("click detected!!!!");
            // console.log($('#raw_html').val());
            // $("#newContent").html($('#raw_html').val());
            // html2canvas($("#newContent"), {
            //     useCORS: false,
            //     logging: true,  
            //     onrendered: function (canvas) {
            //         var canvasImg = canvas.toDataURL("image/jpg");
            //         $('#canvasImg').html('<img src="'+canvasImg+'" alt="">');
            //     }
            // });
        }



    </script>
</body>